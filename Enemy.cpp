#include <Windows.h>
#include <cstdint>

#include "Enemies.h"
#include "Vector3.h"
#include "offsets.h"


Enemies* Enemies::GetEnemies(int index)
{
	static uint32_t moduleBase = (uint32_t)(GetModuleHandle("client_panorama.dll"));
	static uint32_t entityList = moduleBase + hazedumper::signatures::dwEntityList;

	return (Enemies*)(entityList + index * 0x10);
}

int* Enemies::GetMaxEnemies()
{
	static uint32_t moduleBase = (uintptr_t)GetModuleHandle("engine.dll");
	return (int*)(*(uint32_t*)(moduleBase + hazedumper::signatures::dwClientState) + hazedumper::signatures::dwClientState_MaxPlayer);


}

Vector3* Enemies::GetOrigin() 
{
	return (Vector3*)(*(uintptr_t*)this + hazedumper::netvars::m_vecOrigin);
}


Vector3* Enemies::GetViewOffset() 
{
	return (Vector3*)(*(uintptr_t*)this + hazedumper::netvars::m_vecViewOffset);

}

Vector3* Enemies::GetBonePos(int boneID) 
{
	uint32_t boneMatrix = *(uint32_t*)(*(uint32_t*)this + hazedumper::netvars::m_dwBoneMatrix);
	static Vector3 bonePosition;
	bonePosition.x = *(float*)(boneMatrix + 0x30 * boneID + 0x0C);
	bonePosition.y = *(float*)(boneMatrix + 0x30 * boneID + 0x1C);
	bonePosition.z = *(float*)(boneMatrix + 0x30 * boneID + 0x2C);
	return &bonePosition;



}


int* Enemies::GetHealth()
{
	return (int*)(*(uint32_t*)this + hazedumper::netvars::m_iHealth);
}

int* Enemies::GetTeam()
{
	return (int*)(*(uint32_t*)this + hazedumper::netvars::m_iTeamNum);
}